#!/usr/bin/env ruby

$LOAD_PATH.unshift File.expand_path('../lib', __dir__) unless $LOAD_PATH.include?(File.expand_path('../lib', __dir__))


require 'kolom'

interpreter = Kolom::Interpreter.new
if ARGV.empty?
  # Simple REPL (Read-Eval-Print Loop)
  puts "Kolom v#{Kolom::VERSION} - Bengali Scripting REPL"
  puts "Type 'বাহির' or Ctrl+D to exit."
  repl = Kolom::REPL.new
  repl.start
else
  # Execute a file
  if ARGV[0] == '-e'
    code = ARGV[1]
    result, output = interpreter.evaluate(code)
    puts output
    puts "=> #{result.inspect}" unless result.nil?
  else
    filename = ARGV[0]
    unless File.exist?(filename)
      puts "Error: File #{filename} not found"
      exit 1
    end
    code = File.read(filename)
    result, output = interpreter.evaluate(code)
    puts output
    puts "=> #{result.inspect}" unless result.nil?
  end
end